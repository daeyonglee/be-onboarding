# Phase 1 Assignment — Flash Sale 안정화 (구체화 버전)

## 과제명
**"Flash Sale 시간대 랭킹/카테고리/재고 정합성 개선"**

## 배경 시나리오
- 20:00~21:00 이벤트 시간에 트래픽 5배 증가
- 현재 문제
  1. 홈 랭킹 API p95 2.8s
  2. 카테고리 집계 오차 3~5%
  3. 재고 음수 발생(중복 이벤트 처리 실패)

## 목표 SLO
- 랭킹 API p95 < 800ms
- 카테고리 집계 오차 0%
- 재고 음수 0건

---

## 요구사항 A) 랭킹 엔진
- 입력: 최대 1,000,000건
- 출력: Top 100
- 필수 구현
  - PriorityQueue(min-heap) 사용
  - 동점 정책 명시
  - 복잡도/메모리 분석 표 포함

### 수용 기준
- [ ] 100만 건 데이터에서 정상 결과
- [ ] 동점 규칙 100% 일관
- [ ] 정렬 방식 대비 성능 개선 수치 제시

---

## 요구사항 B) 카테고리 집계
- 입력: category tree, rootCategoryId
- 출력: 하위 카테고리 상품 수 총합
- 필수 구현
  - DFS/BFS 중 1개 구현 + 대안 비교
  - cycle detection 포함

### 수용 기준
- [ ] 사이클 데이터에서도 무한루프 없음
- [ ] 루트 기준 하위 전체 누락 없이 집계

---

## 요구사항 C) 재고 이벤트 처리
- 이벤트: ORDER_CREATED / ORDER_CANCELLED
- 필수 구현
  - eventId 기반 idempotency
  - 3회 재시도 + DLQ
  - 구조화 로그(JSON)

### 수용 기준
- [ ] 중복 이벤트 재처리해도 결과 동일
- [ ] 실패 이벤트 DLQ 이동 확인
- [ ] 음수 재고 미발생

---

## 제출물
1. 소스코드
2. 테스트 결과(`tests-report.md`)
3. 성능 결과(`benchmark.md`)
4. 설계근거(`DECISION.md`)

## 평가 루브릭 (100)
- 정확성 35
- 성능 25
- 코드 품질 20
- 설명력 20

## 보너스(+10)
- JMH 또는 자체 벤치 스크립트 자동화
- 실패 주입 테스트(랜덤 예외) 포함
