# Phase 4 Practice — 품질/패턴 실습 가이드 (확장 버전)

## 실습 운영 기준
- Java 17
- 목표: 패턴 적용 + 리팩토링 + 품질 지표 개선
- 테스트: 단위/통합/회귀 테스트 혼합

---

## 실습 1) 프로모션 엔진 Strategy + Factory

### 구현 목표
- 전략 5개 구현
  1. 정액 할인
  2. 정률 할인
  3. 회원등급 할인
  4. 카테고리 한정 할인
  5. 첫구매 할인
- `PromotionStrategyFactory`로 전략 선택 통합

### 테스트
- 전략 단독 8개 이상
- 전략 조합 8개 이상
- 우선순위 충돌 4개 이상

---

## 실습 2) 결제 플로우 Template Method

### 구현 목표
- 공통 단계: validate -> preLog -> execute -> postLog
- 구현체: 승인/취소/재시도
- 실패 훅(`onFailure`) 표준화

### 측정
- 중복 코드 라인 전후 비교
- 실패 로그 필드 일관성 검증

---

## 실습 3) Adapter 교체 가능성 검증

### 구현 목표
- `PaymentPort` 기준으로 2개 PG adapter 구현
- 설정 변경만으로 adapter 전환

### 테스트
- 동일 계약 테스트를 adapter별로 실행
- 응답 매핑 일관성 검증

---

## 실습 4) 긴 메서드 리팩토링

### 대상
- 100줄 이상 메서드 1개
- 중첩 if 4단 이상 메서드 1개

### 요구사항
- 리팩토링 전 테스트 먼저 작성
- 메서드 분해/전략 분리/VO 도입
- 전후 diff와 의도 문서화

---

## 실습 5) 상태 전이 컴포넌트 분리

### 구현 목표
- 주문 상태 전이 규칙을 단일 컴포넌트로 분리
- 전이표 기반 검증 로직 구현

### 테스트
- 허용 전이/불법 전이 케이스
- 예외 코드/메시지 표준 검증

---

## 실습 6) 품질 지표 수집 자동화

### 구현 목표
- 복잡도/중복/커버리지 측정 스크립트 작성
- 리팩토링 전후 결과 자동 비교

### 제출
- `QUALITY_METRICS.md`

---

## 실습 7) 아키텍처 룰 검증

### 구현 목표
- Domain -> Infra 의존 금지 룰 추가
- 룰 위반 예제를 만들어 테스트 실패 확인

---

## 실습 8) 회귀 방지 테스트
- 주요 유스케이스 스냅샷/회귀 테스트 추가
- 전략 추가 시 기존 테스트 깨지지 않는지 검증

---

## 제출물
- `PRACTICE_RESULT.md`
- `QUALITY_METRICS.md`
- `REFACTORING_DIFF.md`
- 테스트 결과 + 지표 캡처
