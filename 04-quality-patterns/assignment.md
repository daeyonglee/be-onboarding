# Phase 4 Assignment — 품질/패턴 고도화 프로젝트 (확장 버전)

## 과제명
"프로모션 엔진 재설계 + 주문 상태 전이 품질 고도화"

## 학습 안내
- 이 과제는 패턴/클린코드 실무 심화 학습 결과를 통합 검증하는 목적입니다.
- `LEARNING_NOTE.md`에 현재 수준과 다음 학습 목표를 명확히 기록합니다.

---

## 문제 배경
- 프로모션 로직이 if-else 400+ 줄로 확장 불가
- 신규 국가/채널 추가 때 분기 폭발
- 상태 전이 로직이 여러 서비스에 중복

---

## 필수 구현 요구사항

### A. 프로모션 엔진
- Strategy + Factory 적용
- 전략 최소 5개
- 우선순위 충돌 규칙 명시
- 신규 전략 추가 시 기존 코드 수정 최소화

### B. 주문 상태 전이
- 상태 전이 규칙 단일 컴포넌트화
- 전이표(state transition table) 작성
- 불법 전이 도메인 예외 처리

### C. 어댑터 경계
- PG adapter 최소 2종
- 포트 계약 테스트 필수

### D. 품질 목표
- 핵심 유스케이스 커버리지 85%+
- 복잡도 상위 메서드 25% 이상 개선
- 중복 코드 라인 35% 이상 감소

### E. 운영성
- traceId/orderId/status 로그 표준화
- 실패 케이스 로그 코드 규칙 정의

---

## 심화 요구사항 (기존보다 확장)
- ArchUnit 등으로 의존성 규칙 자동검증
- 리팩토링 전후 벤치마크(핫패스 1개) 작성
- 코드리뷰 체크리스트를 팀 룰로 변환
- OCP 위반 사례 2개와 개선안 문서화

---

## 테스트 기준
- 총 45개 이상
- 필수 포함
  - 전략별 단위 테스트
  - 전략 조합/우선순위 충돌
  - 상태 전이 불법 케이스
  - adapter 계약 테스트
  - 회귀 테스트

---

## 제출물
1. 코드
2. `PROMOTION_RULES.md`
3. `STATE_TRANSITION_TABLE.md`
4. `REFACTORING_REPORT.md`
5. `QUALITY_METRICS.md`
6. `TEST_REPORT.md`
7. `LEARNING_NOTE.md`

---

## 평가 기준
- 패턴 적용 타당성 30
- 품질 개선 수치 25
- 테스트 안정성 20
- 아키텍처 규칙 준수 15
- 문서/설명력 10
